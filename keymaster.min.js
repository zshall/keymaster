!function(e){var n,t={},o={16:!1,18:!1,17:!1,91:!1},r="all",i={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,command:91},u={backspace:8,tab:9,clear:12,enter:13,return:13,pause:19,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,ins:45,insert:45,del:46,delete:46,home:36,end:35,divide:111,multiply:106,subtract:109,add:107,numpad0:"96",numpad1:"97",numpad2:"98",numpad3:"99",numpad4:"100",numpad5:"101",numpad6:"102",numpad7:"103",numpad8:"104",numpad9:"105",numpadDecimal:"110",pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},a=function(e){return u[e]||i[e]||e.toUpperCase().charCodeAt(0)},l=[];for(n=1;n<20;n++)u["f"+n]=111+n;function c(e,n){for(var t=e.length;t--;)if(e[t]===n)return t;return-1}function f(e,n){if(e.length!=n.length)return!1;for(var t=0;t<e.length;t++)if(e[t]!==n[t])return!1;return!0}var d={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function s(e){for(n in o)o[n]=e[d[n]]}function p(e,n,o){var r,i;r=m(e),void 0===o&&(o=n,n="all");for(var u=0;u<r.length;u++)i=[],(e=r[u].split("+")).length>1&&(i=g(e),e=[e[e.length-1]]),e=e[0],(e=a(e))in t||(t[e]=[]),t[e].push({shortcut:r[u],scope:n,method:o,key:r[u],mods:i})}for(n in i)p[n]=!1;function h(){return r||"all"}function m(e){var n;return""==(n=(e=e.replace(/\s/g,"")).split(","))[n.length-1]&&(n[n.length-2]+=","),n}function g(e){for(var n=e.slice(0,e.length-1),t=0;t<n.length;t++)n[t]=i[n[t]];return n}function y(e,n,t){e.addEventListener?e.addEventListener(n,t,!1):e.attachEvent&&e.attachEvent("on"+n,(function(){t(window.event)}))}"undefined"!=typeof window&&window.document&&(y(window.document,"keydown",(function(e){!function(e){var n,r,u,a,f,d;if(n=e.keyCode,-1==c(l,n)&&l.push(n),93!=n&&224!=n||(n=91),n in o)for(u in o[n]=!0,i)i[u]==n&&(p[u]=!0);else if(s(e),p.filter.call(this,e)&&n in t)for(d=h(),a=0;a<t[n].length;a++)if((r=t[n][a]).scope==d||"all"==r.scope){for(u in f=r.mods.length>0,o)(!o[u]&&c(r.mods,+u)>-1||o[u]&&-1==c(r.mods,+u))&&(f=!1);(0!=r.mods.length||o[16]||o[18]||o[17]||o[91])&&!f||!1===r.method(e,r)&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0))}}(e)})),y(window.document,"keyup",(function(e){var n,t=e.keyCode,r=c(l,t);if(r>=0&&l.splice(r,1),93!=t&&224!=t||(t=91),t in o)for(n in o[t]=!1,i)i[n]==t&&(p[n]=!1)})),y(window,"focus",(function(){for(n in o)o[n]=!1;for(n in i)p[n]=!1;l=[]})));var v=e.key;e.key=p,e.key.setScope=function(e){r=e||"all"},e.key.getScope=h,e.key.deleteScope=function(e){var n,o,r;for(n in t)for(o=t[n],r=0;r<o.length;)o[r].scope===e?o.splice(r,1):r++},e.key.filter=function(e){var n=(e.target||e.srcElement).tagName;return!("INPUT"==n||"SELECT"==n||"TEXTAREA"==n)},e.key.isPressed=function(e){return"string"==typeof e&&(e=a(e)),-1!=c(l,e)},e.key.getPressedKeyCodes=function(){return l.slice(0)},e.key.noConflict=function(){var n=e.key;return e.key=v,n},e.key.unbind=function(e,n){var o,r,i,u,l,c=[];for(o=m(e),u=0;u<o.length;u++){if((r=o[u].split("+")).length>1?(c=g(r),e=r[r.length-1]):(c=[],e=r[0]),e=a(e),void 0===n&&(n=h()),!t[e])return;for(i=0;i<t[e].length;i++)(l=t[e][i]).scope===n&&f(l.mods,c)&&(t[e][i]={})}},"undefined"!=typeof module&&(module.exports=p)}(this);